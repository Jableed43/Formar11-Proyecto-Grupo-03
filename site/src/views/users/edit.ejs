<%- include("../partials/head.ejs") %>

  <body class="log-reg">

    <%- include("../partials/header.ejs") %>

      <main class="login-register">

          <section class="imagen">
            <img src="/images/edit.png" style="width:100%">
            <img id="preview" src="/images/users/<%= userLogin.avatar %>" height="400px">
          </section>
          
          <section class="camposform">
          <h1>Estas editando tus datos</h1>
          <form action="/users/update?_method=PUT" method="POST" enctype="multipart/form-data">

            <div class="campo">
              <label for="name">Nombre Completo</label>
              <input type="text" value="<%= userLogin.name %>" id="name" name="name" placeholder="Ingrese nombre completo..." >
              <% if (locals.errors && errors.name) { %>
                <small class="mensajeError">
                  <%= errores.name.msg %>
                </small>
                <% } %>

                <small class="js-name"> </small>

            </div>

            <div class="campo">
              <label for="email">Correo Electrónico</label>
              <input type="text" value="<%= userLogin.email %>" id="email" name="email" placeholder="Ingrese e-mail...">
              <% if (locals.errors && errors.email) { %>
                <small class="mensajeError">
                  <%= errors.email.msg %>
                </small>
                <% } %>
                <small class="js-email"> </small>

            </div>

            <div class="campo">
              <label for="p1">Contraseña</label>
              <input type="password" id="p1" name="p1" placeholder="Ingrese contraseña...">
            <% if (locals.errors && errors.password) { %>
              <small class="mensajeError"> <%= errors.password.msg %> </small>
              <% } %>
              <small class="js-password1"> </small>

            </div>

            <div class="campo">
              <label for="p2">Confirmar Contraseña</label>
              <input type="password" id="p2" name="p2" placeholder="Ingrese contraseña...">
            <% if (locals.errores && errores.p2) { %>
              <small class="mensajeError"> <%= errores.p2.msg %> </small>
              <% } %>

              <small class="js-password2"> </small>

            </div>



            <div class="campo">
            <label for="user">Sexo</label>
            <select name="sexo" id="sexo">
              <option name="sexo" selected hidden >Seleccione aquí</option>
              
                <% sexes.forEach(sex=> { %>
                  <option value="<%= sex.id %>" <%= userLogin.sex === sex.id  ? 'selected' : null%>><%= sex.name %></option>
                <% }) %>
              </select>
              <% if (locals.errores && errores.sexo) { %>
                <small class="mensajeError"> <%= errores.sexo.msg %> </small>
                <% } %> 
                <small class="js-sexo"> </small>

            </div>

            

            <div class="campo">
            <label for="user">Provincia</label>
            <select name="provincia" id="provincia">
              <option value="provincia" selected hidden>Seleccione aquí</option>
              <% provinces.forEach(province=> { %>
                <option value="<%= province.id %>" <%= userLogin.province === province.id  ? 'selected' : null%>><%= province.name %></option>
              <% }) %>
            </select>
            <% if (locals.errores && errores.provincia) { %>
              <small class="mensajeError"> <%= errores.provincia.msg %> </small>
              <% } %>
              <small class="js-provincia"> </small>

          </div>

          <div class="campo">
          <label>Selecciona una nueva foto de perfil</label>
          <div class="buttons">
          <label for="img" >Subir imagen</label>
          <input type="file" id="img" name="img" oninput="preview.src=window.URL.createObjectURL(this.files[0])" hidden>
          </div>
          <% if (locals.errores && errores.img) { %>
            <small class="mensajeError"> <%= errores.img.msg %> </small>
            <% } %>
            <small class="js-img"> </small>

          </div>

                          <!-- Div de errores -->
                          <div id="divError"> <ul></ul> </div>

            
              <div class="buttons">
              <label for="submit">Editar datos</label>
              <input type="submit" id="submit" value="Editar datos" hidden onclick="datoeditado()">
              </div>

          </form>

          <script type="text/javascript">
            function datoeditado(){
              swal("¡Cambios guardados!", "¡Gracias por actualizar tus datos", "success");
            }
          </script>
        </section>


      </main>

      <%- include("../partials/footer.ejs") %>
      <script src="/javascripts/validacion-edit-user.js"></script>

  </body>

  </html>